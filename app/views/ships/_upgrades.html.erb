<turbo-frame id="ship_upgrades">
  <div class="bg-blue-900 border border-blue-700 p-4 mb-4">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-lime-400 font-bold">Upgrades</h2>
      <div class="text-gray-400 text-sm">
        Max upgrades per attribute: <span class="text-orange-400"><%= Ship::MAX_UPGRADES[ship.hull_size] %></span>
      </div>
    </div>

    <div class="space-y-3">
      <% ship.upgradable_attributes.each do |attr| %>
        <div class="flex items-center justify-between py-2 border-b border-blue-700 last:border-0">
          <div class="flex-1">
            <div class="text-white font-medium"><%= attr[:display_name] %></div>
            <div class="text-sm text-gray-400">
              Current: <span class="text-sky-400"><%= attr[:current_value] %></span>
              <% if attr[:name] == "fuel_efficiency" %>
                → <span class="text-lime-400"><%= (attr[:current_value] + attr[:upgrade_amount]).round(1) %></span>
              <% else %>
                → <span class="text-lime-400"><%= attr[:current_value] + attr[:upgrade_amount] %></span>
              <% end %>
            </div>
            <div class="text-xs text-gray-500">
              Upgraded <%= attr[:current_upgrades] %>/<%= attr[:max_upgrades] %> times
            </div>
          </div>
          
          <div class="flex items-center gap-3">
            <span class="text-orange-400 font-mono text-sm">
              <% if attr[:can_upgrade] %>
                <%= number_with_delimiter(attr[:cost]) %> cr
              <% else %>
                MAXED
              <% end %>
            </span>
            
            <% if attr[:can_upgrade] %>
              <%= button_to upgrade_ship_path(ship, attribute: attr[:name]), 
                  method: :post,
                  class: "px-3 py-1 bg-lime-700 hover:bg-lime-600 text-white text-sm rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",
                  data: { turbo_frame: "_top" } do %>
                Upgrade
              <% end %>
            <% else %>
              <span class="px-3 py-1 bg-gray-700 text-gray-500 text-sm rounded">Maxed</span>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</turbo-frame>
